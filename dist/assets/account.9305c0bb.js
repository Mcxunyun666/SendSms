import{_ as q,a as B,r as u,b as i,o as U,c as D,d as n,F as R,f as j,w as r,D as O,U as N,i as T,s as J,N as m,h as F,e as g,t as M,p as P,j as z,l as E}from"./index.904b712b.js";const G={name:"Account",components:{},setup(){B(()=>{var o;t.value=(o=JSON.parse(window.localStorage.getItem("accountList")))!=null?o:[],c.value=JSON.parse(window.localStorage.getItem("ID"))});const c=u(null),t=u([]),b=u(""),e=u(null),S=u(""),A=u(!1),f=u(!1),_=u(!1),p=()=>history.back(),h=()=>{f.value=!0,b.value="",S.value=""},k=o=>{y(o)},y=o=>{if(c.value=JSON.parse(window.localStorage.getItem("ID")),o!==c.value)return new Promise(l=>{O.confirm({title:"\u786E\u5B9A\u5207\u6362\u8D26\u6237\u5417\uFF1F"}).then(a=>{let s=t.value.find(w=>w.id==o);console.log(s);let d=new Date().getTime(),V={data:{},timestamp:d,sign:N.sisgn(d,s.sign)},L=s.serverUrl+"/config/query";T.post(L,V).then(w=>{w.data.code===200?(N.serverUrl(s.serverUrl),N.sign(s.sign),window.localStorage.setItem("ID",s.id),J.dispatch("SAVE_SERVER_URL",s.serverUrl),J.dispatch("SAVE_SIGN",s.sign),c.value=s.id,c.value=JSON.parse(window.localStorage.getItem("ID")),m({type:"success",message:"\u8D26\u6237\u5207\u6362\u6210\u529F,\u8BF7\u624B\u52A8\u5237\u65B0\u9875\u9762\u751F\u6548\u914D\u7F6E"})):m({type:"danger",message:w.data.msg})}).catch(w=>{m({type:"danger",message:"\u670D\u52A1\u5668\u8FDE\u63A5\u5931\u8D25,\u8BF7\u53F3\u6ED1\u7F16\u8F91\u68C0\u67E5\u8D26\u6237\u4FE1\u606F\u662F\u5426\u6B63\u786E"})})}).catch(()=>{})})},x=o=>{let l=t.value.map(d=>d.id),a=Math.max.apply(null,l);o.id=a+1,t.value.push(o);let s=JSON.stringify(t.value);window.localStorage.setItem("accountList",s),m({type:"success",message:"\u8D26\u6237\u6DFB\u52A0\u6210\u529F,\u8BF7\u9009\u62E9\u8D26\u6237\u8FDB\u884C\u767B\u9646\u6821\u9A8C"}),f.value=!1},I=o=>{o.id=e;let l=t.value.map(s=>s.id).indexOf(e.value);t.value.splice(l,1,o);let a=JSON.stringify(t.value);window.localStorage.setItem("accountList",a),m({type:"success",message:"\u8D26\u6237\u672C\u5730\u4FEE\u6539\u6210\u529F,\u8BF7\u9009\u62E9\u8D26\u6237\u8FDB\u884C\u767B\u9646\u6821\u9A8C"}),_.value=!1},v=o=>{if(o===JSON.parse(window.localStorage.getItem("ID")))return m({type:"warning",message:"\u8BF7\u52FF\u7F16\u8F91\u5F53\u524D\u9009\u62E9\u9879\uFF0C\u4F60\u53EF\u4EE5\u5C1D\u8BD5\u65B0\u589E\u8D26\u6237"});{_.value=!0;let l=t.value.find(a=>a.id===o);b.value=l.serverUrl,S.value=l.sign,e.value=o}};return{onClickLeft:p,onAdd:h,checked:c,show:f,editId:e,editShow:_,username:b,password:S,accountList:t,onSubmit:x,passwordStatus:A,beforeClose:({position:o,name:l})=>{switch(o){case"left":return v(l);case"cell":case"outside":return!0;case"right":return new Promise(a=>{O.confirm({title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F"}).then(s=>{if(l===JSON.parse(window.localStorage.getItem("ID")))return m({type:"warning",message:"\u4E0D\u80FD\u5220\u9664\u5F53\u524D\u542F\u7528\u9879,\u8BF7\u5207\u6362\u8D26\u53F7\u518D\u5C1D\u8BD5\u5220\u9664"});{let d=t.value.map(L=>L.id).indexOf(l);t.value.splice(d,1);let V=JSON.stringify(t.value);window.localStorage.setItem("accountList",V)}}).catch(()=>{})})}},ClickChecked:k,ChangeChecked:y,onEditSubmit:I}}},H=c=>(P("data-v-5bfeba44"),c=c(),z(),c),K={id:"Account"},Q={class:"accountInfo"},W={class:"custom-title"},X=H(()=>g("div",{class:"line"},null,-1)),Y={id:"AccountList"},Z={style:{margin:"16px"}},$=E(" \u786E\u8BA4\u6DFB\u52A0 "),ee={id:"AccountList"},te={style:{margin:"16px"}},ae=E(" \u786E\u8BA4\u4FEE\u6539 ");function oe(c,t,b,e,S,A){const f=i("van-nav-bar"),_=i("van-contact-card"),p=i("van-button"),h=i("van-image"),k=i("van-radio"),y=i("van-cell"),x=i("van-swipe-cell"),I=i("van-radio-group"),v=i("van-field"),C=i("van-cell-group"),o=i("van-form"),l=i("van-action-sheet");return U(),D("div",K,[n(f,{title:"\u8D26\u6237","left-text":"","left-arrow":"",onClickLeft:e.onClickLeft},null,8,["onClickLeft"]),n(_,{type:"add",onClick:e.onAdd,"add-text":"\u6DFB\u52A0\u8D26\u6237"},null,8,["onClick"]),(U(!0),D(R,null,j(e.accountList,(a,s)=>(U(),F(I,{modelValue:e.checked,"onUpdate:modelValue":t[0]||(t[0]=d=>e.checked=d),key:s},{default:r(()=>[n(x,{"before-close":e.beforeClose,name:a.id},{left:r(()=>[n(p,{square:"",type:"primary",class:"delete-button",text:"\u7F16\u8F91"})]),right:r(()=>[n(p,{square:"",text:"\u5220\u9664",type:"danger",class:"delete-button"})]),default:r(()=>[n(y,{center:"",clickable:"",onClick:d=>e.ClickChecked(a.id)},{title:r(()=>[g("div",Q,[n(h,{round:"",width:"2.5rem",height:"2.5rem",src:"https://ui-avatars.com/api/?name="+s+"&background=random&rounded=true"},null,8,["src"]),g("span",W,M(a.serverUrl),1)])]),"right-icon":r(()=>[n(k,{"checked-color":"#ff66ff",name:a.id,onClick:d=>e.ClickChecked(a.id)},null,8,["name","onClick"])]),_:2},1032,["onClick"])]),_:2},1032,["before-close","name"]),X]),_:2},1032,["modelValue"]))),128)),n(l,{show:e.show,"onUpdate:show":t[4]||(t[4]=a=>e.show=a),title:"\u65B0\u589E\u8D26\u6237",style:{height:"50%"}},{default:r(()=>[g("div",Y,[n(h,{round:"",width:"100px",height:"100px",src:"https://img.ichuguang.com/imgs/2022/06/63e13682c4d10b45.jpg"}),n(o,{onSubmit:e.onSubmit},{default:r(()=>[n(C,{inset:""},{default:r(()=>[n(v,{modelValue:e.username,"onUpdate:modelValue":t[1]||(t[1]=a=>e.username=a),name:"serverUrl",label:"\u670D\u52A1\u5668",placeholder:"\u670D\u52A1\u5668",rules:[{required:!0,message:"\u8BF7\u586B\u670D\u52A1\u5668\u5730\u5740"}]},null,8,["modelValue"]),n(v,{modelValue:e.password,"onUpdate:modelValue":t[2]||(t[2]=a=>e.password=a),type:e.passwordStatus?"text":"password","right-icon":e.passwordStatus?"eye":"closed-eye",onClickRightIcon:t[3]||(t[3]=a=>e.passwordStatus=!e.passwordStatus),name:"sign",label:"\u79D8\u94A5",placeholder:"\u79D8\u94A5",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u79D8\u94A5"}]},null,8,["modelValue","type","right-icon"])]),_:1}),g("div",Z,[n(p,{round:"",block:"",type:"primary","native-type":"submit"},{default:r(()=>[$]),_:1})])]),_:1},8,["onSubmit"])])]),_:1},8,["show"]),n(l,{show:e.editShow,"onUpdate:show":t[8]||(t[8]=a=>e.editShow=a),title:"\u4FEE\u6539\u8D26\u6237",style:{height:"50%"}},{default:r(()=>[g("div",ee,[n(h,{round:"",width:"100px",height:"100px",src:"https://img.ichuguang.com/imgs/2022/06/63e13682c4d10b45.jpg"}),n(o,{onSubmit:e.onEditSubmit},{default:r(()=>[n(C,{inset:""},{default:r(()=>[n(v,{modelValue:e.username,"onUpdate:modelValue":t[5]||(t[5]=a=>e.username=a),name:"serverUrl",label:"\u670D\u52A1\u5668",placeholder:"\u670D\u52A1\u5668",rules:[{required:!0,message:"\u8BF7\u586B\u670D\u52A1\u5668\u5730\u5740"}]},null,8,["modelValue"]),n(v,{modelValue:e.password,"onUpdate:modelValue":t[6]||(t[6]=a=>e.password=a),type:e.passwordStatus?"text":"password","right-icon":e.passwordStatus?"eye":"closed-eye",onClickRightIcon:t[7]||(t[7]=a=>e.passwordStatus=!e.passwordStatus),name:"sign",label:"\u79D8\u94A5",placeholder:"\u79D8\u94A5",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u79D8\u94A5"}]},null,8,["modelValue","type","right-icon"])]),_:1}),g("div",te,[n(p,{round:"",block:"",type:"primary","native-type":"submit"},{default:r(()=>[ae]),_:1})])]),_:1},8,["onSubmit"])])]),_:1},8,["show"])])}var se=q(G,[["render",oe],["__scopeId","data-v-5bfeba44"]]);export{se as default};
